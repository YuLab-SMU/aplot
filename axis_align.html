<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Reconcile axis limits | aplot: simplifying the creation of complex graph to visualize associations across diverse data types</title>
  <meta name="description" content="1 Reconcile axis limits | aplot: simplifying the creation of complex graph to visualize associations across diverse data types" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Reconcile axis limits | aplot: simplifying the creation of complex graph to visualize associations across diverse data types" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Reconcile axis limits | aplot: simplifying the creation of complex graph to visualize associations across diverse data types" />
  
  
  



<meta name="date" content="2025-02-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="align-associated-subplots.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="axis_align.html"><a href="axis_align.html"><i class="fa fa-check"></i><b>1</b> Reconcile axis limits</a></li>
<li class="chapter" data-level="2" data-path="align-associated-subplots.html"><a href="align-associated-subplots.html"><i class="fa fa-check"></i><b>2</b> Align associated subplots</a>
<ul>
<li class="chapter" data-level="2.1" data-path="align-associated-subplots.html"><a href="align-associated-subplots.html#a-first-glance"><i class="fa fa-check"></i><b>2.1</b> A first glance</a></li>
<li class="chapter" data-level="2.2" data-path="align-associated-subplots.html"><a href="align-associated-subplots.html#aligning-plots-with-a-tree"><i class="fa fa-check"></i><b>2.2</b> Aligning plots with a tree</a></li>
<li class="chapter" data-level="2.3" data-path="align-associated-subplots.html"><a href="align-associated-subplots.html#annoHeatmap"><i class="fa fa-check"></i><b>2.3</b> Creating annotated heatmap</a></li>
<li class="chapter" data-level="2.4" data-path="align-associated-subplots.html"><a href="align-associated-subplots.html#a-single-cell-example"><i class="fa fa-check"></i><b>2.4</b> A single cell example</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cases.html"><a href="cases.html"><i class="fa fa-check"></i><b>3</b> Cases</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cases.html"><a href="cases.html#pbmc-example"><i class="fa fa-check"></i><b>3.1</b> PBMC example</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="cases.html"><a href="cases.html#marker-gene-heatmap"><i class="fa fa-check"></i><b>3.1.1</b> Marker gene heatmap</a></li>
<li class="chapter" data-level="3.1.2" data-path="cases.html"><a href="cases.html#degree-of-genes-in-the-ppi-network"><i class="fa fa-check"></i><b>3.1.2</b> Degree of genes in the PPI network</a></li>
<li class="chapter" data-level="3.1.3" data-path="cases.html"><a href="cases.html#genes-in-pathways"><i class="fa fa-check"></i><b>3.1.3</b> Genes in pathways</a></li>
<li class="chapter" data-level="3.1.4" data-path="cases.html"><a href="cases.html#all-in-one"><i class="fa fa-check"></i><b>3.1.4</b> All in one</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="cases.html"><a href="cases.html#oncoplot-example"><i class="fa fa-check"></i><b>3.2</b> Oncoplot example</a></li>
<li class="chapter" data-level="3.3" data-path="cases.html"><a href="cases.html#funky-heatmap"><i class="fa fa-check"></i><b>3.3</b> funky heatmap</a></li>
<li class="chapter" data-level="3.4" data-path="cases.html"><a href="cases.html#epigenetics"><i class="fa fa-check"></i><b>3.4</b> Epigenetics</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="cases.html"><a href="cases.html#combine-data"><i class="fa fa-check"></i><b>3.4.1</b> combine data</a></li>
<li class="chapter" data-level="3.4.2" data-path="cases.html"><a href="cases.html#split-data"><i class="fa fa-check"></i><b>3.4.2</b> split data</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">aplot: simplifying the creation of complex graph to visualize associations across diverse data types</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="axis_align" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">1</span> Reconcile axis limits<a href="axis_align.html#axis_align" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Suppose we have the following plots and would like to combine them in a single page.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="axis_align.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="axis_align.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="axis_align.html#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggtree)</span>
<span id="cb1-4"><a href="axis_align.html#cb1-4" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-5"><a href="axis_align.html#cb1-5" tabindex="-1"></a><span class="fu">library</span>(aplot)</span>
<span id="cb1-6"><a href="axis_align.html#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="axis_align.html#cb1-7" tabindex="-1"></a>no_legend<span class="ot">=</span><span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&#39;none&#39;</span>)</span>
<span id="cb1-8"><a href="axis_align.html#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="axis_align.html#cb1-9" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">group_by</span>(mtcars, cyl) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean=</span><span class="fu">mean</span>(disp), <span class="at">sd=</span><span class="fu">sd</span>(disp)) </span>
<span id="cb1-10"><a href="axis_align.html#cb1-10" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(mtcars, cyl <span class="sc">!=</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">var =</span> cyl)</span>
<span id="cb1-11"><a href="axis_align.html#cb1-11" tabindex="-1"></a></span>
<span id="cb1-12"><a href="axis_align.html#cb1-12" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x=</span>cyl, <span class="at">y=</span>mean)) <span class="sc">+</span> </span>
<span id="cb1-13"><a href="axis_align.html#cb1-13" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill=</span><span class="fu">factor</span>(cyl)), <span class="at">width=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb1-14"><a href="axis_align.html#cb1-14" tabindex="-1"></a>    no_legend</span>
<span id="cb1-15"><a href="axis_align.html#cb1-15" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d2, <span class="fu">aes</span>(var, disp)) <span class="sc">+</span> </span>
<span id="cb1-16"><a href="axis_align.html#cb1-16" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(var)), <span class="at">width=</span>.<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb1-17"><a href="axis_align.html#cb1-17" tabindex="-1"></a>    no_legend</span>
<span id="cb1-18"><a href="axis_align.html#cb1-18" tabindex="-1"></a></span>
<span id="cb1-19"><a href="axis_align.html#cb1-19" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(d, cyl <span class="sc">!=</span> <span class="dv">4</span>), <span class="fu">aes</span>(cyl, mean)) <span class="sc">+</span> </span>
<span id="cb1-20"><a href="axis_align.html#cb1-20" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill=</span><span class="fu">factor</span>(cyl)), <span class="at">width=</span>.<span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb1-21"><a href="axis_align.html#cb1-21" tabindex="-1"></a>    no_legend</span>
<span id="cb1-22"><a href="axis_align.html#cb1-22" tabindex="-1"></a></span>
<span id="cb1-23"><a href="axis_align.html#cb1-23" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">list</span>(p1, p2, p3)</span></code></pre></div>
<p>We can use <a href="https://CRAN.R-project.org/package=cowplot">cowplot</a> or <a href="https://CRAN.R-project.org/package=patchwork">patchwork</a> to combine plots.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="axis_align.html#cb2-1" tabindex="-1"></a><span class="fu">plot_list</span>(<span class="at">gglist =</span> pp, <span class="at">ncol=</span><span class="dv">1</span>)</span></code></pre></div>
<p>However, these plots do not align properly (Figure <a href="axis_align.html#fig:axisAlign">1.1</a>A).</p>
<p>There are two reasons:</p>
<ul>
<li>the plotted data have different limits</li>
<li>the different plots have different amounts of expansion spaces</li>
</ul>
<p>To address these two issues, <a href="http://bioconductor.org/packages/ggtree">ggtree</a> provides <code>xlim2()</code> and <code>ylim2()</code> functions to set x or y limits<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. It use input <code>limits</code> to set axis limits that is similar to <code>xlim()</code> and <code>ylim()</code> (Figure <a href="axis_align.html#fig:axisAlign">1.1</a>B). If <code>limits = NULL</code> (by default), the <code>xlim2()</code> and <code>ylim2()</code> functions will calculate axis limits from input <code>ggplot</code> object. So that we can easily set limits of a <code>ggplot</code> object based on another <code>ggplot</code> object to uniformize their limits (Figure <a href="axis_align.html#fig:axisAlign">1.1</a>C).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="axis_align.html#cb3-1" tabindex="-1"></a>pp2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(pp, <span class="cf">function</span>(p) p <span class="sc">+</span> <span class="fu">xlim2</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">11</span>)))</span>
<span id="cb3-2"><a href="axis_align.html#cb3-2" tabindex="-1"></a>pp3 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(pp, <span class="cf">function</span>(p) p <span class="sc">+</span> <span class="fu">xlim2</span>(p1))</span>
<span id="cb3-3"><a href="axis_align.html#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="axis_align.html#cb3-4" tabindex="-1"></a><span class="fu">plot_list</span>(<span class="at">gglist =</span> pp2, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb3-5"><a href="axis_align.html#cb3-5" tabindex="-1"></a><span class="fu">plot_list</span>(<span class="at">gglist =</span> pp3, <span class="at">ncol=</span><span class="dv">1</span>)</span></code></pre></div>
<p>If the plot was flipped, it will throw a message and apply the another axis. In this example, the x limit of <code>p1</code> is applied to y limit of <code>p3</code> as <code>p3</code> was flipped.</p>


<div class="figure"><span style="display:block;" id="fig:axisAlign"></span>
<img src="aplot_files/figure-html/axisAlign-1.png" alt="Setting x-axis limits for aligning plots. Composite plot that does not align properly (A column), align based on user specific limits (B column), and align based on xlim of the p1 object (C column)." width="1152" />
<p class="caption">
Figure 1.1: <strong>Setting x-axis limits for aligning plots.</strong> Composite plot that does not align properly (A column), align based on user specific limits (B column), and align based on xlim of the <code>p1</code> object (C column).
</p>
</div>
<p>Similarly, we can use <code>ylim2()</code> to reconcile y axis. As we can see in Figure <a href="axis_align.html#fig:ylim2">1.2</a>, only panel A and C were aligned properly.</p>


<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="axis_align.html#cb4-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(disp, cyl, <span class="at">group=</span>cyl)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span>
<span id="cb4-2"><a href="axis_align.html#cb4-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(mtcars, cyl<span class="sc">!=</span><span class="dv">8</span>), <span class="fu">aes</span>(disp, cyl, <span class="at">group=</span>cyl)) <span class="sc">+</span> <span class="fu">geom_point</span>() </span>
<span id="cb4-3"><a href="axis_align.html#cb4-3" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">ylim2</span>(p) </span>
<span id="cb4-4"><a href="axis_align.html#cb4-4" tabindex="-1"></a>p <span class="sc">+</span> p1 <span class="sc">+</span> p2 <span class="sc">+</span> </span>
<span id="cb4-5"><a href="axis_align.html#cb4-5" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels=</span><span class="st">&quot;A&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:ylim2"></span>
<img src="aplot_files/figure-html/ylim2-1.png" alt="Setting y-axis limits for aligning plots. Composite plot that does not align properly (A vs B), and align based on ylim of the p object (A vs C)." width="864" />
<p class="caption">
Figure 1.2: <strong>Setting y-axis limits for aligning plots.</strong> Composite plot that does not align properly (A vs B), and align based on ylim of the <code>p</code> object (A vs C).
</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>the implementation was inspired by <a href="https://thackl.github.io/ggtree-composite-plots" class="uri">https://thackl.github.io/ggtree-composite-plots</a><a href="axis_align.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="align-associated-subplots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
