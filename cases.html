<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Cases | aplot: simplifying the creation of complex graph to visualize associations across diverse data types</title>
  <meta name="description" content="3 Cases | aplot: simplifying the creation of complex graph to visualize associations across diverse data types" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Cases | aplot: simplifying the creation of complex graph to visualize associations across diverse data types" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Cases | aplot: simplifying the creation of complex graph to visualize associations across diverse data types" />
  
  
  



<meta name="date" content="2025-02-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="align-associated-subplots.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="axis_align.html"><a href="axis_align.html"><i class="fa fa-check"></i><b>1</b> Reconcile axis limits</a></li>
<li class="chapter" data-level="2" data-path="align-associated-subplots.html"><a href="align-associated-subplots.html"><i class="fa fa-check"></i><b>2</b> Align associated subplots</a>
<ul>
<li class="chapter" data-level="2.1" data-path="align-associated-subplots.html"><a href="align-associated-subplots.html#a-first-glance"><i class="fa fa-check"></i><b>2.1</b> A first glance</a></li>
<li class="chapter" data-level="2.2" data-path="align-associated-subplots.html"><a href="align-associated-subplots.html#aligning-plots-with-a-tree"><i class="fa fa-check"></i><b>2.2</b> Aligning plots with a tree</a></li>
<li class="chapter" data-level="2.3" data-path="align-associated-subplots.html"><a href="align-associated-subplots.html#annoHeatmap"><i class="fa fa-check"></i><b>2.3</b> Creating annotated heatmap</a></li>
<li class="chapter" data-level="2.4" data-path="align-associated-subplots.html"><a href="align-associated-subplots.html#a-single-cell-example"><i class="fa fa-check"></i><b>2.4</b> A single cell example</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cases.html"><a href="cases.html"><i class="fa fa-check"></i><b>3</b> Cases</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cases.html"><a href="cases.html#pbmc-example"><i class="fa fa-check"></i><b>3.1</b> PBMC example</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="cases.html"><a href="cases.html#marker-gene-heatmap"><i class="fa fa-check"></i><b>3.1.1</b> Marker gene heatmap</a></li>
<li class="chapter" data-level="3.1.2" data-path="cases.html"><a href="cases.html#degree-of-genes-in-the-ppi-network"><i class="fa fa-check"></i><b>3.1.2</b> Degree of genes in the PPI network</a></li>
<li class="chapter" data-level="3.1.3" data-path="cases.html"><a href="cases.html#genes-in-pathways"><i class="fa fa-check"></i><b>3.1.3</b> Genes in pathways</a></li>
<li class="chapter" data-level="3.1.4" data-path="cases.html"><a href="cases.html#all-in-one"><i class="fa fa-check"></i><b>3.1.4</b> All in one</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="cases.html"><a href="cases.html#oncoplot-example"><i class="fa fa-check"></i><b>3.2</b> Oncoplot example</a></li>
<li class="chapter" data-level="3.3" data-path="cases.html"><a href="cases.html#funky-heatmap"><i class="fa fa-check"></i><b>3.3</b> funky heatmap</a></li>
<li class="chapter" data-level="3.4" data-path="cases.html"><a href="cases.html#epigenetics"><i class="fa fa-check"></i><b>3.4</b> Epigenetics</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="cases.html"><a href="cases.html#combine-data"><i class="fa fa-check"></i><b>3.4.1</b> combine data</a></li>
<li class="chapter" data-level="3.4.2" data-path="cases.html"><a href="cases.html#split-data"><i class="fa fa-check"></i><b>3.4.2</b> split data</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">aplot: simplifying the creation of complex graph to visualize associations across diverse data types</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cases" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Cases<a href="cases.html#cases" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="pbmc-example" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> PBMC example<a href="cases.html#pbmc-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="marker-gene-heatmap" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Marker gene heatmap<a href="cases.html#marker-gene-heatmap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="cases.html#cb15-1" tabindex="-1"></a><span class="fu">library</span>(yulab.utils)</span>
<span id="cb15-2"><a href="cases.html#cb15-2" tabindex="-1"></a><span class="fu">pload</span>(dplyr)</span>
<span id="cb15-3"><a href="cases.html#cb15-3" tabindex="-1"></a><span class="fu">pload</span>(ggplot2)</span>
<span id="cb15-4"><a href="cases.html#cb15-4" tabindex="-1"></a><span class="fu">pload</span>(ggfun)</span>
<span id="cb15-5"><a href="cases.html#cb15-5" tabindex="-1"></a><span class="fu">pload</span>(ggtree)</span>
<span id="cb15-6"><a href="cases.html#cb15-6" tabindex="-1"></a><span class="fu">pload</span>(aplot)</span>
<span id="cb15-7"><a href="cases.html#cb15-7" tabindex="-1"></a><span class="fu">pload</span>(Seurat)</span>
<span id="cb15-8"><a href="cases.html#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="cases.html#cb15-9" tabindex="-1"></a></span>
<span id="cb15-10"><a href="cases.html#cb15-10" tabindex="-1"></a><span class="co"># celltype &lt;- c(&quot;Naive CD4 T&quot;, &quot;B&quot;, &quot;NK&quot;)</span></span>
<span id="cb15-11"><a href="cases.html#cb15-11" tabindex="-1"></a><span class="co"># id &lt;- pbmc@active.ident</span></span>
<span id="cb15-12"><a href="cases.html#cb15-12" tabindex="-1"></a><span class="co"># md = data.frame(cell=names(id), group=id)</span></span>
<span id="cb15-13"><a href="cases.html#cb15-13" tabindex="-1"></a><span class="co"># md &lt;- md[md$group %in% celltype, ]</span></span>
<span id="cb15-14"><a href="cases.html#cb15-14" tabindex="-1"></a><span class="co"># md$group &lt;- as.character(md$group)</span></span>
<span id="cb15-15"><a href="cases.html#cb15-15" tabindex="-1"></a><span class="co"># md &lt;- lapply(split(md, md$group), function(x) x[1:30,]) |&gt; rbindlist()</span></span>
<span id="cb15-16"><a href="cases.html#cb15-16" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb15-17"><a href="cases.html#cb15-17" tabindex="-1"></a><span class="co"># pbmc &lt;- pbmc[, md$cell]</span></span>
<span id="cb15-18"><a href="cases.html#cb15-18" tabindex="-1"></a></span>
<span id="cb15-19"><a href="cases.html#cb15-19" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> qs<span class="sc">::</span><span class="fu">qread</span>(<span class="st">&quot;data/pbmc-subset.qs&quot;</span>)</span>
<span id="cb15-20"><a href="cases.html#cb15-20" tabindex="-1"></a></span>
<span id="cb15-21"><a href="cases.html#cb15-21" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">FindAllMarkers</span>(pbmc, <span class="at">only.pos=</span><span class="cn">TRUE</span>)</span>
<span id="cb15-22"><a href="cases.html#cb15-22" tabindex="-1"></a></span>
<span id="cb15-23"><a href="cases.html#cb15-23" tabindex="-1"></a>top10 <span class="ot">&lt;-</span> m <span class="sc">%&gt;%</span></span>
<span id="cb15-24"><a href="cases.html#cb15-24" tabindex="-1"></a>    <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb15-25"><a href="cases.html#cb15-25" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(avg_log2FC <span class="sc">&gt;</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-26"><a href="cases.html#cb15-26" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) </span>
<span id="cb15-27"><a href="cases.html#cb15-27" tabindex="-1"></a></span>
<span id="cb15-28"><a href="cases.html#cb15-28" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">ScaleData</span>(pbmc, <span class="at">features =</span> <span class="fu">rownames</span>(pbmc))</span>
<span id="cb15-29"><a href="cases.html#cb15-29" tabindex="-1"></a>x  <span class="ot">&lt;-</span> pbmc[[<span class="st">&#39;RNA&#39;</span>]]<span class="sc">$</span>scale.data[top10<span class="sc">$</span>gene,]</span>
<span id="cb15-30"><a href="cases.html#cb15-30" tabindex="-1"></a></span>
<span id="cb15-31"><a href="cases.html#cb15-31" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">mat2df</span>(x) <span class="ot">-&gt;</span> y</span>
<span id="cb15-32"><a href="cases.html#cb15-32" tabindex="-1"></a>y<span class="sc">$</span>gene <span class="ot">&lt;-</span> <span class="fu">rownames</span>(x)[y<span class="sc">$</span>row]</span>
<span id="cb15-33"><a href="cases.html#cb15-33" tabindex="-1"></a>y<span class="sc">$</span>cell <span class="ot">&lt;-</span> <span class="fu">colnames</span>(x)[y<span class="sc">$</span>col]</span>
<span id="cb15-34"><a href="cases.html#cb15-34" tabindex="-1"></a></span>
<span id="cb15-35"><a href="cases.html#cb15-35" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(y, <span class="fu">aes</span>(cell, gene, <span class="at">fill =</span> value)) <span class="sc">+</span> </span>
<span id="cb15-36"><a href="cases.html#cb15-36" tabindex="-1"></a>    <span class="fu">geom_tile</span>()<span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>(<span class="at">name =</span> <span class="st">&quot;Gene Expression&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-37"><a href="cases.html#cb15-37" tabindex="-1"></a>    <span class="fu">theme_noxaxis</span>() <span class="sc">+</span></span>
<span id="cb15-38"><a href="cases.html#cb15-38" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(<span class="at">position =</span> <span class="st">&quot;right&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-39"><a href="cases.html#cb15-39" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb15-40"><a href="cases.html#cb15-40" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span>
<span id="cb15-41"><a href="cases.html#cb15-41" tabindex="-1"></a></span>
<span id="cb15-42"><a href="cases.html#cb15-42" tabindex="-1"></a>gene_cls <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>((x)))</span>
<span id="cb15-43"><a href="cases.html#cb15-43" tabindex="-1"></a>cell_cls <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(<span class="fu">t</span>((x)))) </span>
<span id="cb15-44"><a href="cases.html#cb15-44" tabindex="-1"></a>gene_tree <span class="ot">&lt;-</span> <span class="fu">ggtree</span>(gene_cls, <span class="at">branch.length =</span> <span class="st">&#39;none&#39;</span>)</span>
<span id="cb15-45"><a href="cases.html#cb15-45" tabindex="-1"></a>cell_tree <span class="ot">=</span> <span class="fu">ggtree</span>(cell_cls, <span class="at">branch.length =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span> <span class="fu">layout_dendrogram</span>()</span>
<span id="cb15-46"><a href="cases.html#cb15-46" tabindex="-1"></a></span>
<span id="cb15-47"><a href="cases.html#cb15-47" tabindex="-1"></a></span>
<span id="cb15-48"><a href="cases.html#cb15-48" tabindex="-1"></a>id <span class="ot">&lt;-</span> pbmc<span class="sc">@</span>active.ident</span>
<span id="cb15-49"><a href="cases.html#cb15-49" tabindex="-1"></a>md <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">cell=</span><span class="fu">names</span>(id), <span class="at">group=</span>id)</span>
<span id="cb15-50"><a href="cases.html#cb15-50" tabindex="-1"></a>p_cell_type <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(md, <span class="fu">aes</span>(cell, <span class="at">y=</span><span class="dv">1</span>, <span class="at">fill =</span> group)) <span class="sc">+</span> </span>
<span id="cb15-51"><a href="cases.html#cb15-51" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> </span>
<span id="cb15-52"><a href="cases.html#cb15-52" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Set1&quot;</span>, <span class="at">name =</span> <span class="st">&#39;Cell Type&#39;</span>) <span class="sc">+</span></span>
<span id="cb15-53"><a href="cases.html#cb15-53" tabindex="-1"></a>    <span class="fu">theme_nothing</span>()</span>
<span id="cb15-54"><a href="cases.html#cb15-54" tabindex="-1"></a></span>
<span id="cb15-55"><a href="cases.html#cb15-55" tabindex="-1"></a>g <span class="ot">&lt;-</span> p <span class="sc">|&gt;</span> <span class="fu">insert_left</span>(gene_tree, <span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-56"><a href="cases.html#cb15-56" tabindex="-1"></a>    <span class="fu">insert_top</span>(p_cell_type, <span class="at">height =</span> .<span class="dv">02</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-57"><a href="cases.html#cb15-57" tabindex="-1"></a>    <span class="fu">insert_top</span>(cell_tree, <span class="at">height =</span> .<span class="dv">1</span>)</span>
<span id="cb15-58"><a href="cases.html#cb15-58" tabindex="-1"></a></span>
<span id="cb15-59"><a href="cases.html#cb15-59" tabindex="-1"></a>g</span></code></pre></div>
<p><img src="aplot_files/figure-html/marker-gene-heatmap-1.png" width="960" /></p>
</div>
<div id="degree-of-genes-in-the-ppi-network" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Degree of genes in the PPI network<a href="cases.html#degree-of-genes-in-the-ppi-network" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="cases.html#cb16-1" tabindex="-1"></a><span class="fu">pload</span>(igraph)</span>
<span id="cb16-2"><a href="cases.html#cb16-2" tabindex="-1"></a><span class="fu">pload</span>(clusterProfiler)</span>
<span id="cb16-3"><a href="cases.html#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="cases.html#cb16-4" tabindex="-1"></a>ppi <span class="ot">&lt;-</span> <span class="fu">getPPI</span>(top10<span class="sc">$</span>gene, <span class="at">output=</span><span class="st">&#39;igraph&#39;</span>, <span class="at">taxID=</span><span class="st">&#39;9606&#39;</span>) </span>
<span id="cb16-5"><a href="cases.html#cb16-5" tabindex="-1"></a>deg <span class="ot">&lt;-</span> <span class="fu">stack</span>(<span class="fu">degree</span>(ppi, <span class="at">v =</span> <span class="fu">V</span>(ppi))) <span class="sc">|&gt;</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;degree&quot;</span>, <span class="st">&quot;gene&quot;</span>))</span>
<span id="cb16-6"><a href="cases.html#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="cases.html#cb16-7" tabindex="-1"></a>p_ppi <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(deg, <span class="fu">aes</span>(<span class="dv">1</span>, gene, <span class="at">fill=</span>degree, <span class="at">size=</span>degree)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="dv">21</span>) <span class="sc">+</span> </span>
<span id="cb16-8"><a href="cases.html#cb16-8" tabindex="-1"></a>    <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">hcl.colors</span>(<span class="dv">20</span>, <span class="st">&quot;RdYlGn&quot;</span>)) <span class="sc">+</span> <span class="fu">theme_nothing</span>()</span></code></pre></div>
</div>
<div id="genes-in-pathways" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Genes in pathways<a href="cases.html#genes-in-pathways" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="cases.html#cb17-1" tabindex="-1"></a><span class="fu">pload</span>(tidytree)</span>
<span id="cb17-2"><a href="cases.html#cb17-2" tabindex="-1"></a><span class="fu">pload</span>(msigdbr)</span>
<span id="cb17-3"><a href="cases.html#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="cases.html#cb17-4" tabindex="-1"></a>node <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">34</span>, <span class="dv">32</span>)</span>
<span id="cb17-5"><a href="cases.html#cb17-5" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">lapply</span>(node, <span class="cf">function</span>(n) <span class="fu">offspring</span>(gene_tree, n, <span class="at">tiponly=</span>T)<span class="sc">$</span>label) <span class="sc">|&gt;</span></span>
<span id="cb17-6"><a href="cases.html#cb17-6" tabindex="-1"></a>    <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;NK&quot;</span>, <span class="st">&quot;B&quot;</span>))</span>
<span id="cb17-7"><a href="cases.html#cb17-7" tabindex="-1"></a></span>
<span id="cb17-8"><a href="cases.html#cb17-8" tabindex="-1"></a><span class="fu">pload</span>(clusterProfiler)</span>
<span id="cb17-9"><a href="cases.html#cb17-9" tabindex="-1"></a>gene_set <span class="ot">&lt;-</span> <span class="fu">msigdbr</span>(<span class="at">species=</span><span class="st">&quot;human&quot;</span>, <span class="at">category=</span><span class="st">&quot;C2&quot;</span>)</span>
<span id="cb17-10"><a href="cases.html#cb17-10" tabindex="-1"></a><span class="fu">names</span>(gene_set)</span></code></pre></div>
<pre><code>##  [1] &quot;gs_cat&quot;             &quot;gs_subcat&quot;         
##  [3] &quot;gs_name&quot;            &quot;gene_symbol&quot;       
##  [5] &quot;entrez_gene&quot;        &quot;ensembl_gene&quot;      
##  [7] &quot;human_gene_symbol&quot;  &quot;human_entrez_gene&quot; 
##  [9] &quot;human_ensembl_gene&quot; &quot;gs_id&quot;             
## [11] &quot;gs_pmid&quot;            &quot;gs_geoid&quot;          
## [13] &quot;gs_exact_source&quot;    &quot;gs_url&quot;            
## [15] &quot;gs_description&quot;</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="cases.html#cb19-1" tabindex="-1"></a>cc <span class="ot">&lt;-</span> <span class="fu">compareCluster</span>(genes, enricher, <span class="at">TERM2GENE=</span>gene_set[, <span class="fu">c</span>(<span class="st">&quot;gs_name&quot;</span>, <span class="st">&quot;gene_symbol&quot;</span>)])</span>
<span id="cb19-2"><a href="cases.html#cb19-2" tabindex="-1"></a>res <span class="ot">&lt;-</span> cc<span class="sc">@</span>compareClusterResult <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="cases.html#cb19-3" tabindex="-1"></a>    <span class="fu">group_by</span>(Cluster) <span class="sc">|&gt;</span> </span>
<span id="cb19-4"><a href="cases.html#cb19-4" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-5"><a href="cases.html#cb19-5" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb19-6"><a href="cases.html#cb19-6" tabindex="-1"></a></span>
<span id="cb19-7"><a href="cases.html#cb19-7" tabindex="-1"></a>gene2path <span class="ot">&lt;-</span> <span class="fu">lapply</span>(res<span class="sc">$</span>geneID, <span class="cf">function</span>(x) <span class="fu">unlist</span>(<span class="fu">strsplit</span>(x, <span class="at">split=</span><span class="st">&quot;/&quot;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb19-8"><a href="cases.html#cb19-8" tabindex="-1"></a>    <span class="fu">setNames</span>(res<span class="sc">$</span>Description) <span class="sc">|&gt;</span></span>
<span id="cb19-9"><a href="cases.html#cb19-9" tabindex="-1"></a>    <span class="fu">stack</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-10"><a href="cases.html#cb19-10" tabindex="-1"></a>    <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;gene&quot;</span>, <span class="st">&quot;pathway&quot;</span>))</span>
<span id="cb19-11"><a href="cases.html#cb19-11" tabindex="-1"></a></span>
<span id="cb19-12"><a href="cases.html#cb19-12" tabindex="-1"></a>pcp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gene2path, <span class="fu">aes</span>(pathway, gene))  <span class="sc">+</span></span>
<span id="cb19-13"><a href="cases.html#cb19-13" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-14"><a href="cases.html#cb19-14" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb19-15"><a href="cases.html#cb19-15" tabindex="-1"></a>    <span class="fu">theme_noyaxis</span>() <span class="sc">+</span></span>
<span id="cb19-16"><a href="cases.html#cb19-16" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">30</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb19-17"><a href="cases.html#cb19-17" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb19-18"><a href="cases.html#cb19-18" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span>
<span id="cb19-19"><a href="cases.html#cb19-19" tabindex="-1"></a></span>
<span id="cb19-20"><a href="cases.html#cb19-20" tabindex="-1"></a>gg <span class="ot">&lt;-</span> g <span class="sc">|&gt;</span> <span class="fu">insert_right</span>(p_ppi, <span class="at">width=</span>.<span class="dv">05</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-21"><a href="cases.html#cb19-21" tabindex="-1"></a>    <span class="fu">insert_right</span>(pcp, <span class="at">width=</span>.<span class="dv">5</span>) </span>
<span id="cb19-22"><a href="cases.html#cb19-22" tabindex="-1"></a>gg</span></code></pre></div>
<p><img src="aplot_files/figure-html/pcp-1.png" width="1536" /></p>
</div>
<div id="all-in-one" class="section level3 hasAnchor" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> All in one<a href="cases.html#all-in-one" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="cases.html#cb20-1" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">plot_list</span>(cell_tree, p_cell_type, <span class="at">heights=</span><span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">5</span>))</span>
<span id="cb20-2"><a href="cases.html#cb20-2" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">plot_list</span>(gene_tree, pp, <span class="at">widths=</span><span class="fu">c</span>(.<span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb20-3"><a href="cases.html#cb20-3" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">plot_list</span>(p, pp, p_ppi, pcp, <span class="at">widths=</span><span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">8</span>, .<span class="dv">05</span>, .<span class="dv">6</span>))</span>
<span id="cb20-4"><a href="cases.html#cb20-4" tabindex="-1"></a>pp <span class="ot">&lt;-</span> pp <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels=</span><span class="st">&#39;a&#39;</span>)</span>
<span id="cb20-5"><a href="cases.html#cb20-5" tabindex="-1"></a></span>
<span id="cb20-6"><a href="cases.html#cb20-6" tabindex="-1"></a>final_plot <span class="ot">&lt;-</span> <span class="fu">plot_list</span>(pp, gg, <span class="at">ncol=</span><span class="dv">1</span>, <span class="at">tag_levels=</span><span class="st">&#39;A&#39;</span>, <span class="at">heights=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.2</span>))</span>
<span id="cb20-7"><a href="cases.html#cb20-7" tabindex="-1"></a>final_plot</span></code></pre></div>
<p><img src="aplot_files/figure-html/all-1.png" width="1536" /></p>
</div>
</div>
<div id="oncoplot-example" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Oncoplot example<a href="cases.html#oncoplot-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="cases.html#cb21-1" tabindex="-1"></a><span class="fu">pload</span>(aplotExtra)</span>
<span id="cb21-2"><a href="cases.html#cb21-2" tabindex="-1"></a><span class="fu">pload</span>(RTCGA.mRNA)</span>
<span id="cb21-3"><a href="cases.html#cb21-3" tabindex="-1"></a><span class="fu">pload</span>(RTCGA)</span>
<span id="cb21-4"><a href="cases.html#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="cases.html#cb21-5" tabindex="-1"></a>laml.maf <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;tcga_laml.maf.gz&quot;</span>, <span class="at">package =</span> <span class="st">&quot;maftools&quot;</span>)</span>
<span id="cb21-6"><a href="cases.html#cb21-6" tabindex="-1"></a>laml.clin <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&#39;extdata&#39;</span>, <span class="st">&#39;tcga_laml_annot.tsv&#39;</span>, <span class="at">package =</span> <span class="st">&#39;maftools&#39;</span>)</span>
<span id="cb21-7"><a href="cases.html#cb21-7" tabindex="-1"></a>laml <span class="ot">&lt;-</span> maftools<span class="sc">::</span><span class="fu">read.maf</span>(<span class="at">maf =</span> laml.maf, <span class="at">clinicalData =</span> laml.clin)</span></code></pre></div>
<pre><code>## -Reading
## -Validating
## -Silent variants: 475 
## -Summarizing
## -Processing clinical data
## -Finished in 0.260s elapsed (0.000s cpu)</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="cases.html#cb23-1" tabindex="-1"></a>onco <span class="ot">&lt;-</span> <span class="fu">oncoplot</span>(<span class="at">maf =</span> laml, <span class="at">genes =</span> <span class="dv">20</span>)</span>
<span id="cb23-2"><a href="cases.html#cb23-2" tabindex="-1"></a></span>
<span id="cb23-3"><a href="cases.html#cb23-3" tabindex="-1"></a>plot_tcga_expr <span class="ot">&lt;-</span> <span class="cf">function</span>(mRNA, genes, <span class="at">name =</span> <span class="st">&quot;Gene Expression&quot;</span>) {</span>
<span id="cb23-4"><a href="cases.html#cb23-4" tabindex="-1"></a>    d <span class="ot">=</span> <span class="fu">expressionsTCGA</span>(mRNA, <span class="at">extract.cols =</span> genes)</span>
<span id="cb23-5"><a href="cases.html#cb23-5" tabindex="-1"></a></span>
<span id="cb23-6"><a href="cases.html#cb23-6" tabindex="-1"></a>    dd <span class="ot">=</span> <span class="fu">gather</span>(d, gene, expression, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb23-7"><a href="cases.html#cb23-7" tabindex="-1"></a>    </span>
<span id="cb23-8"><a href="cases.html#cb23-8" tabindex="-1"></a>    <span class="fu">ggplot</span>(dd, <span class="fu">aes</span>(expression, gene, <span class="at">fill=</span><span class="fu">stat</span>(x))) <span class="sc">+</span> </span>
<span id="cb23-9"><a href="cases.html#cb23-9" tabindex="-1"></a>        ggridges<span class="sc">::</span><span class="fu">geom_density_ridges_gradient</span>() <span class="sc">+</span></span>
<span id="cb23-10"><a href="cases.html#cb23-10" tabindex="-1"></a>        <span class="fu">scale_fill_viridis_c</span>(<span class="at">option=</span><span class="st">&quot;C&quot;</span>, <span class="at">name =</span> name) <span class="sc">+</span></span>
<span id="cb23-11"><a href="cases.html#cb23-11" tabindex="-1"></a>        <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-12"><a href="cases.html#cb23-12" tabindex="-1"></a>        <span class="fu">theme_noyaxis</span>() <span class="sc">+</span> </span>
<span id="cb23-13"><a href="cases.html#cb23-13" tabindex="-1"></a>        <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb23-14"><a href="cases.html#cb23-14" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb23-15"><a href="cases.html#cb23-15" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&#39;bottom&#39;</span>)</span>
<span id="cb23-16"><a href="cases.html#cb23-16" tabindex="-1"></a>}</span>
<span id="cb23-17"><a href="cases.html#cb23-17" tabindex="-1"></a></span>
<span id="cb23-18"><a href="cases.html#cb23-18" tabindex="-1"></a>onco_genes <span class="ot">&lt;-</span> aplotExtra<span class="sc">:::</span><span class="fu">get_oncoplot_genes</span>(laml)</span>
<span id="cb23-19"><a href="cases.html#cb23-19" tabindex="-1"></a>brca <span class="ot">&lt;-</span> <span class="fu">plot_tcga_expr</span>(BRCA.mRNA, onco_genes, <span class="st">&quot;Gene Expression in TCGA</span><span class="sc">\n</span><span class="st">breast cancer patients&quot;</span>)</span>
<span id="cb23-20"><a href="cases.html#cb23-20" tabindex="-1"></a>ov <span class="ot">&lt;-</span> <span class="fu">plot_tcga_expr</span>(OV.mRNA, onco_genes, <span class="st">&quot;Gene Expression in TCGA</span><span class="sc">\n</span><span class="st">ovarian cancer patients&quot;</span>)</span>
<span id="cb23-21"><a href="cases.html#cb23-21" tabindex="-1"></a></span>
<span id="cb23-22"><a href="cases.html#cb23-22" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">insert_right</span>(onco, brca, <span class="at">width =</span> .<span class="dv">6</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-23"><a href="cases.html#cb23-23" tabindex="-1"></a>    <span class="fu">insert_right</span>(ov, <span class="at">width=</span>.<span class="dv">6</span>)</span>
<span id="cb23-24"><a href="cases.html#cb23-24" tabindex="-1"></a>op</span></code></pre></div>
<p><img src="aplot_files/figure-html/onco-1.png" width="1536" /></p>
</div>
<div id="funky-heatmap" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> funky heatmap<a href="cases.html#funky-heatmap" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="cases.html#cb24-1" tabindex="-1"></a><span class="fu">library</span>(aplotExtra)</span>
<span id="cb24-2"><a href="cases.html#cb24-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb24-3"><a href="cases.html#cb24-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;mtcars&quot;</span>)</span>
<span id="cb24-4"><a href="cases.html#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="cases.html#cb24-5" tabindex="-1"></a></span>
<span id="cb24-6"><a href="cases.html#cb24-6" tabindex="-1"></a>d <span class="ot">&lt;-</span> yulab.utils<span class="sc">::</span><span class="fu">scale_range</span>(mtcars) <span class="sc">|&gt;</span></span>
<span id="cb24-7"><a href="cases.html#cb24-7" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">&quot;id&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-8"><a href="cases.html#cb24-8" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(mpg))</span>
<span id="cb24-9"><a href="cases.html#cb24-9" tabindex="-1"></a></span>
<span id="cb24-10"><a href="cases.html#cb24-10" tabindex="-1"></a></span>
<span id="cb24-11"><a href="cases.html#cb24-11" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">funky_text</span>(d)</span>
<span id="cb24-12"><a href="cases.html#cb24-12" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">funky_bar</span>(d, <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;#CC4C02&quot;</span>, <span class="at">high =</span> <span class="st">&quot;#FFFFE5&quot;</span>)</span>
<span id="cb24-13"><a href="cases.html#cb24-13" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">funky_bar</span>(d, <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">high =</span> <span class="st">&quot;firebrick&quot;</span>) </span>
<span id="cb24-14"><a href="cases.html#cb24-14" tabindex="-1"></a>g4 <span class="ot">&lt;-</span> <span class="fu">funky_point</span>(d, <span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>) <span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;#CC4C02&quot;</span>, <span class="at">high =</span> <span class="st">&quot;#FFFFE5&quot;</span>)</span>
<span id="cb24-15"><a href="cases.html#cb24-15" tabindex="-1"></a>g5 <span class="ot">&lt;-</span> <span class="fu">funky_point</span>(d, <span class="dv">8</span><span class="sc">:</span><span class="dv">12</span>) <span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;#08519C&quot;</span>, <span class="at">high =</span> <span class="st">&quot;#F7FBFF&quot;</span>) </span>
<span id="cb24-16"><a href="cases.html#cb24-16" tabindex="-1"></a></span>
<span id="cb24-17"><a href="cases.html#cb24-17" tabindex="-1"></a></span>
<span id="cb24-18"><a href="cases.html#cb24-18" tabindex="-1"></a><span class="co">#funky_heatmap(data=mtcars)</span></span>
<span id="cb24-19"><a href="cases.html#cb24-19" tabindex="-1"></a>fp <span class="ot">&lt;-</span> <span class="fu">funky_heatmap</span>(g1, g2, g4, g5, <span class="at">options=</span><span class="fu">theme_stamp</span>())</span>
<span id="cb24-20"><a href="cases.html#cb24-20" tabindex="-1"></a>fp</span></code></pre></div>
<p><img src="aplot_files/figure-html/funky-1.png" width="768" /></p>
</div>
<div id="epigenetics" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Epigenetics<a href="cases.html#epigenetics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this part, we will show case of epigenetics by using aplot to integrate the visualization
of hic data, ChIP-seq data and gene track. Hic data will be manipulated and visualized by
<code>HiContacts</code> and <code>HiCExperiment</code>. ChIP-seq data will be manipulated and visualize by <code>ChIPseeker</code>.
Gene track will be visualized by <code>gggenes</code> by fetching gene information from txdb object.
aplot will show its power by combining these three parts of epigenetics result.</p>
<p>The purpose of this case is to show the different epigenetics characteristics of cell line
GM12878(normal lymphoblastoid cell line) and cell line K562(chronic myeloid leukemia cell lines).
Hic data are derived from GSM1551550(GM12878) and GSM1551618(K562).
ChIP-seq data have four parts: H3K27ac, H3K4me1, H3K4me3 and H3K36me3.
ChIP-seq Control data are derived from GSM733742(GM12878) and GSM733780(K562).
ChIP-seq H3K27ac data are derived from GSM733771(GM12878) and GSM733656(K562).
ChIP-seq H3K4me1 data are derived from GSM733772(GM12878) and GSM733692 (K562).
ChIP-seq H3K4me3 data are derived from GSM733708(GM12878) and GSM733680(K562).
ChIP-seq H3K36me3 data are derived from GSM733771(GSM733679) and GSM733656(GSM733714).
We download the bam files and re-analyze it by using macs2 to get peak results and different peak results.
Gene track visualization is implemented by using gggenes.</p>
<p>In order to manifest the strength of aplot, we will show the usages of aplot in two parts.
combine data is the comparison result. The comparison result of Hic data are calculated by using <code>HiContacts::divide</code> to get
foldchange(K562/GM12878). The comparison result of ChIP-seq data are calculated by using the <code>bdgdiff</code> function of <code>macs2</code>.
split data is to exhibit the hic data and ChIP-seq data of two cell lines individually.
All the data is pre-calculated and store in a .qs file.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="cases.html#cb25-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb25-2"><a href="cases.html#cb25-2" tabindex="-1"></a><span class="fu">library</span>(TxDb.Hsapiens.UCSC.hg19.knownGene)</span>
<span id="cb25-3"><a href="cases.html#cb25-3" tabindex="-1"></a><span class="fu">library</span>(aplot)</span>
<span id="cb25-4"><a href="cases.html#cb25-4" tabindex="-1"></a><span class="fu">library</span>(ChIPseeker)</span>
<span id="cb25-5"><a href="cases.html#cb25-5" tabindex="-1"></a><span class="fu">library</span>(clusterProfiler)</span>
<span id="cb25-6"><a href="cases.html#cb25-6" tabindex="-1"></a><span class="fu">library</span>(org.Hs.eg.db)</span>
<span id="cb25-7"><a href="cases.html#cb25-7" tabindex="-1"></a><span class="fu">library</span>(IRanges)</span>
<span id="cb25-8"><a href="cases.html#cb25-8" tabindex="-1"></a><span class="fu">library</span>(GenomicFeatures)</span>
<span id="cb25-9"><a href="cases.html#cb25-9" tabindex="-1"></a><span class="fu">library</span>(gggenes)</span>
<span id="cb25-10"><a href="cases.html#cb25-10" tabindex="-1"></a></span>
<span id="cb25-11"><a href="cases.html#cb25-11" tabindex="-1"></a>scale <span class="ot">&lt;-</span> <span class="st">&quot;log10&quot;</span></span>
<span id="cb25-12"><a href="cases.html#cb25-12" tabindex="-1"></a>limits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.7</span>)</span>
<span id="cb25-13"><a href="cases.html#cb25-13" tabindex="-1"></a>chr <span class="ot">&lt;-</span> <span class="st">&quot;chr6&quot;</span></span>
<span id="cb25-14"><a href="cases.html#cb25-14" tabindex="-1"></a>chr_hic <span class="ot">&lt;-</span> <span class="st">&quot;6&quot;</span></span>
<span id="cb25-15"><a href="cases.html#cb25-15" tabindex="-1"></a>x_min <span class="ot">&lt;-</span> <span class="dv">43600000</span></span>
<span id="cb25-16"><a href="cases.html#cb25-16" tabindex="-1"></a>x_max <span class="ot">&lt;-</span> <span class="dv">44100000</span></span>
<span id="cb25-17"><a href="cases.html#cb25-17" tabindex="-1"></a>txdb <span class="ot">&lt;-</span> TxDb.Hsapiens.UCSC.hg19.knownGene</span>
<span id="cb25-18"><a href="cases.html#cb25-18" tabindex="-1"></a>epigenetics_data <span class="ot">&lt;-</span> qs<span class="sc">::</span><span class="fu">qread</span>(<span class="st">&quot;./data/epigenetics_data.qs&quot;</span>)</span>
<span id="cb25-19"><a href="cases.html#cb25-19" tabindex="-1"></a></span>
<span id="cb25-20"><a href="cases.html#cb25-20" tabindex="-1"></a><span class="co"># functions to visualize gene track</span></span>
<span id="cb25-21"><a href="cases.html#cb25-21" tabindex="-1"></a>getPlotGene <span class="ot">&lt;-</span> <span class="cf">function</span>(txdb, chr, x_min, x_max, <span class="at">tx_id =</span> <span class="cn">NULL</span>,</span>
<span id="cb25-22"><a href="cases.html#cb25-22" tabindex="-1"></a>                        <span class="at">OrgDb =</span> <span class="cn">NULL</span>){</span>
<span id="cb25-23"><a href="cases.html#cb25-23" tabindex="-1"></a></span>
<span id="cb25-24"><a href="cases.html#cb25-24" tabindex="-1"></a>    win <span class="ot">&lt;-</span> <span class="fu">GRanges</span>(<span class="at">seqnames =</span> chr,</span>
<span id="cb25-25"><a href="cases.html#cb25-25" tabindex="-1"></a>                   <span class="at">ranges =</span> IRanges<span class="sc">::</span><span class="fu">IRanges</span>(<span class="at">start =</span> x_min, <span class="at">end =</span> x_max))</span>
<span id="cb25-26"><a href="cases.html#cb25-26" tabindex="-1"></a>    all_genes <span class="ot">&lt;-</span> GenomicFeatures<span class="sc">::</span><span class="fu">genes</span>(txdb)</span>
<span id="cb25-27"><a href="cases.html#cb25-27" tabindex="-1"></a>    gene_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subsetByOverlaps</span>(<span class="at">x =</span> all_genes, <span class="at">ranges =</span> win, <span class="at">type =</span> <span class="st">&quot;any&quot;</span>))</span>
<span id="cb25-28"><a href="cases.html#cb25-28" tabindex="-1"></a>    gene_df[gene_df[, <span class="st">&quot;start&quot;</span>] <span class="sc">&lt;</span> x_min, <span class="st">&quot;start&quot;</span>] <span class="ot">&lt;-</span> x_min</span>
<span id="cb25-29"><a href="cases.html#cb25-29" tabindex="-1"></a>    gene_df[gene_df[, <span class="st">&quot;end&quot;</span>] <span class="sc">&gt;</span> x_max, <span class="st">&quot;end&quot;</span>] <span class="ot">&lt;-</span> x_max</span>
<span id="cb25-30"><a href="cases.html#cb25-30" tabindex="-1"></a>    gene_df<span class="sc">$</span>gene_id <span class="ot">&lt;-</span> <span class="fu">factor</span>(gene_df<span class="sc">$</span>gene_id, <span class="at">levels =</span> <span class="fu">unique</span>(gene_df<span class="sc">$</span>gene_id))</span>
<span id="cb25-31"><a href="cases.html#cb25-31" tabindex="-1"></a>    </span>
<span id="cb25-32"><a href="cases.html#cb25-32" tabindex="-1"></a>    gene_df <span class="ot">&lt;-</span> gene_df[,<span class="fu">c</span>(<span class="st">&quot;seqnames&quot;</span>, <span class="st">&quot;gene_id&quot;</span>, <span class="st">&quot;start&quot;</span>, <span class="st">&quot;end&quot;</span>, <span class="st">&quot;strand&quot;</span>)]</span>
<span id="cb25-33"><a href="cases.html#cb25-33" tabindex="-1"></a>    <span class="fu">colnames</span>(gene_df)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;chromosome&quot;</span></span>
<span id="cb25-34"><a href="cases.html#cb25-34" tabindex="-1"></a>    gene_df<span class="sc">$</span>forward <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gene_df<span class="sc">$</span>strand<span class="sc">==</span><span class="st">&quot;+&quot;</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb25-35"><a href="cases.html#cb25-35" tabindex="-1"></a></span>
<span id="cb25-36"><a href="cases.html#cb25-36" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(OrgDb)){</span>
<span id="cb25-37"><a href="cases.html#cb25-37" tabindex="-1"></a>      <span class="fu">require</span>(clusterProfiler)</span>
<span id="cb25-38"><a href="cases.html#cb25-38" tabindex="-1"></a>      <span class="fu">require</span>(OrgDb , <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-39"><a href="cases.html#cb25-39" tabindex="-1"></a></span>
<span id="cb25-40"><a href="cases.html#cb25-40" tabindex="-1"></a>      changeid <span class="ot">&lt;-</span> <span class="fu">bitr</span>(<span class="at">geneID =</span> gene_df<span class="sc">$</span>gene_id, </span>
<span id="cb25-41"><a href="cases.html#cb25-41" tabindex="-1"></a>                       <span class="at">fromType =</span> <span class="st">&quot;ENTREZID&quot;</span>, <span class="at">toType =</span> <span class="st">&quot;SYMBOL&quot;</span>,</span>
<span id="cb25-42"><a href="cases.html#cb25-42" tabindex="-1"></a>                       <span class="at">OrgDb =</span> OrgDb)</span>
<span id="cb25-43"><a href="cases.html#cb25-43" tabindex="-1"></a>      <span class="fu">colnames</span>(changeid)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;gene_id&quot;</span>) </span>
<span id="cb25-44"><a href="cases.html#cb25-44" tabindex="-1"></a>      gene_df <span class="ot">&lt;-</span> <span class="fu">merge</span>(gene_df, changeid)</span>
<span id="cb25-45"><a href="cases.html#cb25-45" tabindex="-1"></a>      gene_df <span class="ot">&lt;-</span> gene_df[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(gene_df))]</span>
<span id="cb25-46"><a href="cases.html#cb25-46" tabindex="-1"></a>      <span class="fu">colnames</span>(gene_df)[<span class="fu">ncol</span>(gene_df)] <span class="ot">&lt;-</span> <span class="st">&quot;gene_symbol&quot;</span></span>
<span id="cb25-47"><a href="cases.html#cb25-47" tabindex="-1"></a>    }</span>
<span id="cb25-48"><a href="cases.html#cb25-48" tabindex="-1"></a></span>
<span id="cb25-49"><a href="cases.html#cb25-49" tabindex="-1"></a>    <span class="fu">return</span>(gene_df)</span>
<span id="cb25-50"><a href="cases.html#cb25-50" tabindex="-1"></a>}</span>
<span id="cb25-51"><a href="cases.html#cb25-51" tabindex="-1"></a></span>
<span id="cb25-52"><a href="cases.html#cb25-52" tabindex="-1"></a></span>
<span id="cb25-53"><a href="cases.html#cb25-53" tabindex="-1"></a>plotGene <span class="ot">&lt;-</span> <span class="cf">function</span>(df,<span class="at">x_min =</span> <span class="cn">NULL</span>, <span class="at">x_max =</span> <span class="cn">NULL</span>){</span>
<span id="cb25-54"><a href="cases.html#cb25-54" tabindex="-1"></a>  </span>
<span id="cb25-55"><a href="cases.html#cb25-55" tabindex="-1"></a>  <span class="fu">require</span>(gggenes)</span>
<span id="cb25-56"><a href="cases.html#cb25-56" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(x_min)){</span>
<span id="cb25-57"><a href="cases.html#cb25-57" tabindex="-1"></a>    x_min <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">c</span>(df[, <span class="st">&quot;start&quot;</span>], df[, <span class="st">&quot;end&quot;</span>]))</span>
<span id="cb25-58"><a href="cases.html#cb25-58" tabindex="-1"></a>  }</span>
<span id="cb25-59"><a href="cases.html#cb25-59" tabindex="-1"></a></span>
<span id="cb25-60"><a href="cases.html#cb25-60" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(x_max)){</span>
<span id="cb25-61"><a href="cases.html#cb25-61" tabindex="-1"></a>    x_max <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">c</span>(df[, <span class="st">&quot;start&quot;</span>], df[, <span class="st">&quot;end&quot;</span>]))</span>
<span id="cb25-62"><a href="cases.html#cb25-62" tabindex="-1"></a>  }</span>
<span id="cb25-63"><a href="cases.html#cb25-63" tabindex="-1"></a></span>
<span id="cb25-64"><a href="cases.html#cb25-64" tabindex="-1"></a>  gene_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">xmin =</span> start, <span class="at">xmax =</span> end, </span>
<span id="cb25-65"><a href="cases.html#cb25-65" tabindex="-1"></a>                           <span class="at">y =</span> gene_symbol, <span class="at">forward=</span>forward, <span class="at">fill =</span> gene_symbol)) <span class="sc">+</span></span>
<span id="cb25-66"><a href="cases.html#cb25-66" tabindex="-1"></a>                    <span class="fu">geom_gene_arrow</span>() <span class="sc">+</span></span>
<span id="cb25-67"><a href="cases.html#cb25-67" tabindex="-1"></a>                    <span class="fu">xlim</span>(<span class="fu">c</span>(x_min, x_max))<span class="sc">+</span></span>
<span id="cb25-68"><a href="cases.html#cb25-68" tabindex="-1"></a>                    <span class="fu">theme_genes</span>() <span class="sc">+</span></span>
<span id="cb25-69"><a href="cases.html#cb25-69" tabindex="-1"></a>                    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span>
<span id="cb25-70"><a href="cases.html#cb25-70" tabindex="-1"></a>  <span class="fu">return</span>(gene_p)</span>
<span id="cb25-71"><a href="cases.html#cb25-71" tabindex="-1"></a>}</span></code></pre></div>
<div id="combine-data" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> combine data<a href="cases.html#combine-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="cases.html#cb26-1" tabindex="-1"></a>combine_hic_p <span class="ot">&lt;-</span> HiContacts<span class="sc">::</span><span class="fu">plotMatrix</span>(epigenetics_data[[<span class="st">&quot;div_hic&quot;</span>]], </span>
<span id="cb26-2"><a href="cases.html#cb26-2" tabindex="-1"></a>                                        <span class="at">use.scores =</span> <span class="st">&quot;balanced.fc&quot;</span>,</span>
<span id="cb26-3"><a href="cases.html#cb26-3" tabindex="-1"></a>                                        <span class="at">maxDistance =</span> x_max <span class="sc">-</span> x_min,<span class="at">caption =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-4"><a href="cases.html#cb26-4" tabindex="-1"></a>                                        <span class="at">cmap =</span> HiContacts<span class="sc">::</span><span class="fu">bbrColors</span>()) <span class="sc">+</span> </span>
<span id="cb26-5"><a href="cases.html#cb26-5" tabindex="-1"></a>                        <span class="fu">xlim</span>(x_min, x_max) <span class="sc">+</span></span>
<span id="cb26-6"><a href="cases.html#cb26-6" tabindex="-1"></a>                        <span class="fu">ylab</span>(<span class="st">&quot;K562/GM12878 hic compare &quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;log2fc&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-7"><a href="cases.html#cb26-7" tabindex="-1"></a>                        <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb26-8"><a href="cases.html#cb26-8" tabindex="-1"></a>                              <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-9"><a href="cases.html#cb26-9" tabindex="-1"></a>                              <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-10"><a href="cases.html#cb26-10" tabindex="-1"></a>                              <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>))</span>
<span id="cb26-11"><a href="cases.html#cb26-11" tabindex="-1"></a></span>
<span id="cb26-12"><a href="cases.html#cb26-12" tabindex="-1"></a>peak_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#E05B5B&quot;</span>,<span class="st">&quot;#519CBA&quot;</span>)</span>
<span id="cb26-13"><a href="cases.html#cb26-13" tabindex="-1"></a><span class="fu">names</span>(peak_color) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;peak_in_K562&quot;</span>, <span class="st">&quot;peak_in_GM12878&quot;</span>)</span>
<span id="cb26-14"><a href="cases.html#cb26-14" tabindex="-1"></a></span>
<span id="cb26-15"><a href="cases.html#cb26-15" tabindex="-1"></a>H3K27ac_p <span class="ot">&lt;-</span> <span class="fu">covplot</span>(epigenetics_data[[<span class="st">&quot;H3K27ac_peak&quot;</span>]], </span>
<span id="cb26-16"><a href="cases.html#cb26-16" tabindex="-1"></a>                     <span class="at">weightCol=</span><span class="st">&quot;V5&quot;</span>, <span class="at">chrs=</span>chr, <span class="at">xlim=</span><span class="fu">c</span>(x_min, x_max),</span>
<span id="cb26-17"><a href="cases.html#cb26-17" tabindex="-1"></a>                     <span class="at">ylab =</span> <span class="st">&quot;H3K27ac&quot;</span>, <span class="at">title =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-18"><a href="cases.html#cb26-18" tabindex="-1"></a>                <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">43737946</span>,<span class="at">xmax =</span> <span class="dv">43754223</span>,</span>
<span id="cb26-19"><a href="cases.html#cb26-19" tabindex="-1"></a>                         <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">100</span>, <span class="at">fill =</span> <span class="st">&quot;#c6c3c3&quot;</span>, <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb26-20"><a href="cases.html#cb26-20" tabindex="-1"></a>                <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">43900000</span>,<span class="at">xmax =</span> <span class="dv">44000000</span>,</span>
<span id="cb26-21"><a href="cases.html#cb26-21" tabindex="-1"></a>                         <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">100</span>, <span class="at">fill =</span> <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb26-22"><a href="cases.html#cb26-22" tabindex="-1"></a>                <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">44060000</span>,<span class="at">xmax =</span> <span class="dv">44100000</span>,</span>
<span id="cb26-23"><a href="cases.html#cb26-23" tabindex="-1"></a>                         <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">100</span>, <span class="at">fill =</span> <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb26-24"><a href="cases.html#cb26-24" tabindex="-1"></a>                <span class="fu">scale_color_manual</span>(<span class="at">values =</span> peak_color) <span class="sc">+</span></span>
<span id="cb26-25"><a href="cases.html#cb26-25" tabindex="-1"></a>                <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> peak_color) <span class="sc">+</span></span>
<span id="cb26-26"><a href="cases.html#cb26-26" tabindex="-1"></a>                <span class="fu">theme</span>(<span class="at">strip.text.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb26-27"><a href="cases.html#cb26-27" tabindex="-1"></a></span>
<span id="cb26-28"><a href="cases.html#cb26-28" tabindex="-1"></a></span>
<span id="cb26-29"><a href="cases.html#cb26-29" tabindex="-1"></a>H3K36me3_p <span class="ot">&lt;-</span> <span class="fu">covplot</span>(epigenetics_data[[<span class="st">&quot;H3K36me3_peak&quot;</span>]], </span>
<span id="cb26-30"><a href="cases.html#cb26-30" tabindex="-1"></a>                      <span class="at">weightCol=</span><span class="st">&quot;V5&quot;</span>, <span class="at">chrs=</span>chr, <span class="at">xlim=</span><span class="fu">c</span>(x_min, x_max),</span>
<span id="cb26-31"><a href="cases.html#cb26-31" tabindex="-1"></a>                      <span class="at">ylab =</span> <span class="st">&quot;H3K36me3&quot;</span>, <span class="at">title =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-32"><a href="cases.html#cb26-32" tabindex="-1"></a>                <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">43737946</span>,<span class="at">xmax =</span> <span class="dv">43754223</span>,</span>
<span id="cb26-33"><a href="cases.html#cb26-33" tabindex="-1"></a>                         <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">10</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb26-34"><a href="cases.html#cb26-34" tabindex="-1"></a>                <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">43900000</span>,<span class="at">xmax =</span> <span class="dv">44000000</span>,</span>
<span id="cb26-35"><a href="cases.html#cb26-35" tabindex="-1"></a>                         <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">10</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb26-36"><a href="cases.html#cb26-36" tabindex="-1"></a>                <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">44060000</span>,<span class="at">xmax =</span> <span class="dv">44100000</span>,</span>
<span id="cb26-37"><a href="cases.html#cb26-37" tabindex="-1"></a>                         <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">10</span>,</span>
<span id="cb26-38"><a href="cases.html#cb26-38" tabindex="-1"></a>                         <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb26-39"><a href="cases.html#cb26-39" tabindex="-1"></a>                <span class="fu">scale_color_manual</span>(<span class="at">values =</span> peak_color) <span class="sc">+</span></span>
<span id="cb26-40"><a href="cases.html#cb26-40" tabindex="-1"></a>                <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> peak_color) <span class="sc">+</span></span>
<span id="cb26-41"><a href="cases.html#cb26-41" tabindex="-1"></a>                <span class="fu">theme</span>(<span class="at">strip.text.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb26-42"><a href="cases.html#cb26-42" tabindex="-1"></a></span>
<span id="cb26-43"><a href="cases.html#cb26-43" tabindex="-1"></a></span>
<span id="cb26-44"><a href="cases.html#cb26-44" tabindex="-1"></a>H3K4me1_p <span class="ot">&lt;-</span> <span class="fu">covplot</span>(epigenetics_data[[<span class="st">&quot;H3K4me1_peak&quot;</span>]], </span>
<span id="cb26-45"><a href="cases.html#cb26-45" tabindex="-1"></a>                     <span class="at">weightCol=</span><span class="st">&quot;V5&quot;</span>, <span class="at">chrs=</span>chr, <span class="at">xlim=</span><span class="fu">c</span>(x_min, x_max),</span>
<span id="cb26-46"><a href="cases.html#cb26-46" tabindex="-1"></a>                     <span class="at">ylab =</span> <span class="st">&quot;H3K4me1&quot;</span>, <span class="at">title =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-47"><a href="cases.html#cb26-47" tabindex="-1"></a>                <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">43737946</span>,<span class="at">xmax =</span> <span class="dv">43754223</span>,</span>
<span id="cb26-48"><a href="cases.html#cb26-48" tabindex="-1"></a>                         <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">30</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb26-49"><a href="cases.html#cb26-49" tabindex="-1"></a>                <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">43900000</span>,<span class="at">xmax =</span> <span class="dv">44000000</span>,</span>
<span id="cb26-50"><a href="cases.html#cb26-50" tabindex="-1"></a>                         <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">30</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb26-51"><a href="cases.html#cb26-51" tabindex="-1"></a>                <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">44060000</span>,<span class="at">xmax =</span> <span class="dv">44100000</span>,</span>
<span id="cb26-52"><a href="cases.html#cb26-52" tabindex="-1"></a>                         <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">30</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb26-53"><a href="cases.html#cb26-53" tabindex="-1"></a>                <span class="fu">scale_color_manual</span>(<span class="at">values =</span> peak_color) <span class="sc">+</span></span>
<span id="cb26-54"><a href="cases.html#cb26-54" tabindex="-1"></a>                <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> peak_color) <span class="sc">+</span></span>
<span id="cb26-55"><a href="cases.html#cb26-55" tabindex="-1"></a>                <span class="fu">theme</span>(<span class="at">strip.text.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb26-56"><a href="cases.html#cb26-56" tabindex="-1"></a></span>
<span id="cb26-57"><a href="cases.html#cb26-57" tabindex="-1"></a></span>
<span id="cb26-58"><a href="cases.html#cb26-58" tabindex="-1"></a>H3K4me3_p <span class="ot">&lt;-</span> <span class="fu">covplot</span>(epigenetics_data[[<span class="st">&quot;H3K4me3_peak&quot;</span>]], </span>
<span id="cb26-59"><a href="cases.html#cb26-59" tabindex="-1"></a>                     <span class="at">weightCol=</span><span class="st">&quot;V5&quot;</span>, <span class="at">chrs=</span>chr, <span class="at">xlim=</span><span class="fu">c</span>(x_min, x_max),</span>
<span id="cb26-60"><a href="cases.html#cb26-60" tabindex="-1"></a>                     <span class="at">ylab =</span> <span class="st">&quot;H3K4me3&quot;</span>, <span class="at">title =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-61"><a href="cases.html#cb26-61" tabindex="-1"></a>                <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">43737946</span>,<span class="at">xmax =</span> <span class="dv">43754223</span>,</span>
<span id="cb26-62"><a href="cases.html#cb26-62" tabindex="-1"></a>                         <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">25</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb26-63"><a href="cases.html#cb26-63" tabindex="-1"></a>                <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">43900000</span>,<span class="at">xmax =</span> <span class="dv">44000000</span>,</span>
<span id="cb26-64"><a href="cases.html#cb26-64" tabindex="-1"></a>                         <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">25</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb26-65"><a href="cases.html#cb26-65" tabindex="-1"></a>                <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">44060000</span>,<span class="at">xmax =</span> <span class="dv">44100000</span>,</span>
<span id="cb26-66"><a href="cases.html#cb26-66" tabindex="-1"></a>                         <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">25</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb26-67"><a href="cases.html#cb26-67" tabindex="-1"></a>                <span class="fu">scale_color_manual</span>(<span class="at">values =</span> peak_color) <span class="sc">+</span></span>
<span id="cb26-68"><a href="cases.html#cb26-68" tabindex="-1"></a>                <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> peak_color) <span class="sc">+</span></span>
<span id="cb26-69"><a href="cases.html#cb26-69" tabindex="-1"></a>                <span class="fu">theme</span>(<span class="at">strip.text.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb26-70"><a href="cases.html#cb26-70" tabindex="-1"></a></span>
<span id="cb26-71"><a href="cases.html#cb26-71" tabindex="-1"></a>gene_p <span class="ot">&lt;-</span> <span class="fu">plotGene</span>(<span class="at">df =</span> <span class="fu">getPlotGene</span>(<span class="at">txdb =</span> txdb, </span>
<span id="cb26-72"><a href="cases.html#cb26-72" tabindex="-1"></a>                                    <span class="at">chr =</span> chr, </span>
<span id="cb26-73"><a href="cases.html#cb26-73" tabindex="-1"></a>                                    <span class="at">x_min =</span> x_min, </span>
<span id="cb26-74"><a href="cases.html#cb26-74" tabindex="-1"></a>                                    <span class="at">x_max =</span> x_max,<span class="at">OrgDb =</span> <span class="st">&quot;org.Hs.eg.db&quot;</span>),</span>
<span id="cb26-75"><a href="cases.html#cb26-75" tabindex="-1"></a>                    <span class="at">x_min =</span> x_min,</span>
<span id="cb26-76"><a href="cases.html#cb26-76" tabindex="-1"></a>                    <span class="at">x_max =</span> x_max) <span class="sc">+</span> </span>
<span id="cb26-77"><a href="cases.html#cb26-77" tabindex="-1"></a>                    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set3&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-78"><a href="cases.html#cb26-78" tabindex="-1"></a>                    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;gene symbol&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-79"><a href="cases.html#cb26-79" tabindex="-1"></a>                        <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb26-80"><a href="cases.html#cb26-80" tabindex="-1"></a>                                 <span class="at">xmin =</span> <span class="dv">43737946</span>,<span class="at">xmax =</span> <span class="dv">43754223</span>,</span>
<span id="cb26-81"><a href="cases.html#cb26-81" tabindex="-1"></a>                                 <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">9</span>,</span>
<span id="cb26-82"><a href="cases.html#cb26-82" tabindex="-1"></a>                                 <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb26-83"><a href="cases.html#cb26-83" tabindex="-1"></a>                        <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb26-84"><a href="cases.html#cb26-84" tabindex="-1"></a>                                 <span class="at">xmin =</span> <span class="dv">43900000</span>,<span class="at">xmax =</span> <span class="dv">44000000</span>,</span>
<span id="cb26-85"><a href="cases.html#cb26-85" tabindex="-1"></a>                                 <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">9</span>,</span>
<span id="cb26-86"><a href="cases.html#cb26-86" tabindex="-1"></a>                                 <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb26-87"><a href="cases.html#cb26-87" tabindex="-1"></a>                        <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,</span>
<span id="cb26-88"><a href="cases.html#cb26-88" tabindex="-1"></a>                                 <span class="at">xmin =</span> <span class="dv">44060000</span>,<span class="at">xmax =</span> <span class="dv">44100000</span>,</span>
<span id="cb26-89"><a href="cases.html#cb26-89" tabindex="-1"></a>                                 <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">9</span>,</span>
<span id="cb26-90"><a href="cases.html#cb26-90" tabindex="-1"></a>                                 <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>)</span>
<span id="cb26-91"><a href="cases.html#cb26-91" tabindex="-1"></a></span>
<span id="cb26-92"><a href="cases.html#cb26-92" tabindex="-1"></a>p <span class="ot">&lt;-</span> combine_hic_p <span class="sc">%&gt;%</span> </span>
<span id="cb26-93"><a href="cases.html#cb26-93" tabindex="-1"></a>            <span class="fu">insert_bottom</span>(H3K27ac_p,<span class="at">height =</span> .<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-94"><a href="cases.html#cb26-94" tabindex="-1"></a>            <span class="fu">insert_bottom</span>(H3K36me3_p,<span class="at">height =</span> .<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-95"><a href="cases.html#cb26-95" tabindex="-1"></a>            <span class="fu">insert_bottom</span>(H3K4me1_p,<span class="at">height =</span> .<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-96"><a href="cases.html#cb26-96" tabindex="-1"></a>            <span class="fu">insert_bottom</span>(H3K4me3_p,<span class="at">height =</span> .<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-97"><a href="cases.html#cb26-97" tabindex="-1"></a>        <span class="fu">insert_bottom</span>(gene_p, <span class="at">height =</span> .<span class="dv">5</span>)</span>
<span id="cb26-98"><a href="cases.html#cb26-98" tabindex="-1"></a></span>
<span id="cb26-99"><a href="cases.html#cb26-99" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="aplot_files/figure-html/combine_data-1.png" width="960" /></p>
</div>
<div id="split-data" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> split data<a href="cases.html#split-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="cases.html#cb27-1" tabindex="-1"></a>gene_p <span class="ot">&lt;-</span> <span class="fu">plotGene</span>(<span class="at">df =</span> <span class="fu">getPlotGene</span>(<span class="at">txdb =</span> txdb, </span>
<span id="cb27-2"><a href="cases.html#cb27-2" tabindex="-1"></a>                                    <span class="at">chr =</span> chr, </span>
<span id="cb27-3"><a href="cases.html#cb27-3" tabindex="-1"></a>                                    <span class="at">x_min =</span> x_min, </span>
<span id="cb27-4"><a href="cases.html#cb27-4" tabindex="-1"></a>                                    <span class="at">x_max =</span> x_max,<span class="at">OrgDb =</span> <span class="st">&quot;org.Hs.eg.db&quot;</span>),</span>
<span id="cb27-5"><a href="cases.html#cb27-5" tabindex="-1"></a>                    <span class="at">x_min =</span> x_min,</span>
<span id="cb27-6"><a href="cases.html#cb27-6" tabindex="-1"></a>                    <span class="at">x_max =</span> x_max) <span class="sc">+</span> </span>
<span id="cb27-7"><a href="cases.html#cb27-7" tabindex="-1"></a>                    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set3&quot;</span>) <span class="sc">+</span> </span>
<span id="cb27-8"><a href="cases.html#cb27-8" tabindex="-1"></a>                    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;gene symbol&quot;</span>)<span class="sc">+</span> </span>
<span id="cb27-9"><a href="cases.html#cb27-9" tabindex="-1"></a>                  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">43737946</span>,<span class="at">xmax =</span> <span class="dv">43754223</span>,</span>
<span id="cb27-10"><a href="cases.html#cb27-10" tabindex="-1"></a>                           <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">9</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb27-11"><a href="cases.html#cb27-11" tabindex="-1"></a>                  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">43900000</span>,<span class="at">xmax =</span> <span class="dv">44000000</span>,</span>
<span id="cb27-12"><a href="cases.html#cb27-12" tabindex="-1"></a>                           <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">9</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb27-13"><a href="cases.html#cb27-13" tabindex="-1"></a>                  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">44060000</span>,<span class="at">xmax =</span> <span class="dv">44100000</span>,</span>
<span id="cb27-14"><a href="cases.html#cb27-14" tabindex="-1"></a>                           <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">9</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>)</span>
<span id="cb27-15"><a href="cases.html#cb27-15" tabindex="-1"></a></span>
<span id="cb27-16"><a href="cases.html#cb27-16" tabindex="-1"></a></span>
<span id="cb27-17"><a href="cases.html#cb27-17" tabindex="-1"></a>GM12878_hic_p <span class="ot">&lt;-</span> HiContacts<span class="sc">::</span><span class="fu">plotMatrix</span>(epigenetics_data[[<span class="st">&quot;GM12878_hic&quot;</span>]], </span>
<span id="cb27-18"><a href="cases.html#cb27-18" tabindex="-1"></a>                                        <span class="at">maxDistance =</span> x_max <span class="sc">-</span> x_min,</span>
<span id="cb27-19"><a href="cases.html#cb27-19" tabindex="-1"></a>                                        <span class="at">caption =</span> <span class="cn">FALSE</span>, </span>
<span id="cb27-20"><a href="cases.html#cb27-20" tabindex="-1"></a>                                        <span class="at">scale =</span> scale, <span class="at">limits =</span> limits) <span class="sc">+</span> </span>
<span id="cb27-21"><a href="cases.html#cb27-21" tabindex="-1"></a>                        <span class="fu">xlim</span>(x_min, x_max) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&#39;hic score&#39;</span>) <span class="sc">+</span></span>
<span id="cb27-22"><a href="cases.html#cb27-22" tabindex="-1"></a>                        <span class="fu">ylab</span>(<span class="st">&quot;GM12878 hic&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb27-23"><a href="cases.html#cb27-23" tabindex="-1"></a>                        <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb27-24"><a href="cases.html#cb27-24" tabindex="-1"></a>                              <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-25"><a href="cases.html#cb27-25" tabindex="-1"></a>                              <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-26"><a href="cases.html#cb27-26" tabindex="-1"></a>                              <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>))</span>
<span id="cb27-27"><a href="cases.html#cb27-27" tabindex="-1"></a></span>
<span id="cb27-28"><a href="cases.html#cb27-28" tabindex="-1"></a></span>
<span id="cb27-29"><a href="cases.html#cb27-29" tabindex="-1"></a>GM12878_cov_p <span class="ot">&lt;-</span> <span class="fu">covplot</span>(epigenetics_data[[<span class="st">&quot;GM12878_peak&quot;</span>]], </span>
<span id="cb27-30"><a href="cases.html#cb27-30" tabindex="-1"></a>                         <span class="at">weightCol=</span><span class="st">&quot;V5&quot;</span>, <span class="at">chrs=</span>chr, <span class="at">xlim=</span><span class="fu">c</span>(x_min, x_max),</span>
<span id="cb27-31"><a href="cases.html#cb27-31" tabindex="-1"></a>                         <span class="at">ylab =</span> <span class="st">&quot;GM12878 ChIP-seq&quot;</span>, <span class="at">title =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb27-32"><a href="cases.html#cb27-32" tabindex="-1"></a>                        <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2000</span>)) <span class="sc">+</span></span>
<span id="cb27-33"><a href="cases.html#cb27-33" tabindex="-1"></a>                        <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">43737946</span>,<span class="at">xmax =</span> <span class="dv">43754223</span>,</span>
<span id="cb27-34"><a href="cases.html#cb27-34" tabindex="-1"></a>                                 <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">2000</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb27-35"><a href="cases.html#cb27-35" tabindex="-1"></a>                        <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">43900000</span>,<span class="at">xmax =</span> <span class="dv">44000000</span>,</span>
<span id="cb27-36"><a href="cases.html#cb27-36" tabindex="-1"></a>                                 <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">2000</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb27-37"><a href="cases.html#cb27-37" tabindex="-1"></a>                        <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">44060000</span>,<span class="at">xmax =</span> <span class="dv">44100000</span>,</span>
<span id="cb27-38"><a href="cases.html#cb27-38" tabindex="-1"></a>                                 <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">2000</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb27-39"><a href="cases.html#cb27-39" tabindex="-1"></a>                        <span class="fu">facet_grid</span>(.id <span class="sc">~</span> .) <span class="sc">+</span>  </span>
<span id="cb27-40"><a href="cases.html#cb27-40" tabindex="-1"></a>                        <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-41"><a href="cases.html#cb27-41" tabindex="-1"></a>                        <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span> </span>
<span id="cb27-42"><a href="cases.html#cb27-42" tabindex="-1"></a>                        <span class="fu">theme</span>(<span class="at">strip.text.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb27-43"><a href="cases.html#cb27-43" tabindex="-1"></a>                        </span>
<span id="cb27-44"><a href="cases.html#cb27-44" tabindex="-1"></a></span>
<span id="cb27-45"><a href="cases.html#cb27-45" tabindex="-1"></a>GM12878_p <span class="ot">&lt;-</span> (GM12878_hic_p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>))  <span class="sc">%&gt;%</span> </span>
<span id="cb27-46"><a href="cases.html#cb27-46" tabindex="-1"></a>             <span class="fu">insert_bottom</span>(GM12878_cov_p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-47"><a href="cases.html#cb27-47" tabindex="-1"></a>             <span class="fu">insert_bottom</span>(gene_p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>), <span class="at">height =</span> .<span class="dv">6</span>)</span>
<span id="cb27-48"><a href="cases.html#cb27-48" tabindex="-1"></a></span>
<span id="cb27-49"><a href="cases.html#cb27-49" tabindex="-1"></a></span>
<span id="cb27-50"><a href="cases.html#cb27-50" tabindex="-1"></a>K562_hic_p <span class="ot">&lt;-</span> HiContacts<span class="sc">::</span><span class="fu">plotMatrix</span>(epigenetics_data[[<span class="st">&quot;K562_hic&quot;</span>]], </span>
<span id="cb27-51"><a href="cases.html#cb27-51" tabindex="-1"></a>                                     <span class="at">maxDistance =</span> x_max <span class="sc">-</span> x_min,</span>
<span id="cb27-52"><a href="cases.html#cb27-52" tabindex="-1"></a>                                     <span class="at">caption =</span> <span class="cn">FALSE</span>, <span class="at">scale =</span> scale, </span>
<span id="cb27-53"><a href="cases.html#cb27-53" tabindex="-1"></a>                                     <span class="at">limits =</span> limits) <span class="sc">+</span> </span>
<span id="cb27-54"><a href="cases.html#cb27-54" tabindex="-1"></a>                        <span class="fu">xlim</span>(x_min, x_max) <span class="sc">+</span></span>
<span id="cb27-55"><a href="cases.html#cb27-55" tabindex="-1"></a>                        <span class="fu">ylab</span>(<span class="st">&quot;K562 hic&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&#39;hic score&#39;</span>) <span class="sc">+</span></span>
<span id="cb27-56"><a href="cases.html#cb27-56" tabindex="-1"></a>                        <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb27-57"><a href="cases.html#cb27-57" tabindex="-1"></a>                              <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-58"><a href="cases.html#cb27-58" tabindex="-1"></a>                              <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-59"><a href="cases.html#cb27-59" tabindex="-1"></a>                              <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>))</span>
<span id="cb27-60"><a href="cases.html#cb27-60" tabindex="-1"></a></span>
<span id="cb27-61"><a href="cases.html#cb27-61" tabindex="-1"></a></span>
<span id="cb27-62"><a href="cases.html#cb27-62" tabindex="-1"></a>K562_cov_p <span class="ot">&lt;-</span> <span class="fu">covplot</span>(epigenetics_data[[<span class="st">&quot;K562_peak&quot;</span>]], </span>
<span id="cb27-63"><a href="cases.html#cb27-63" tabindex="-1"></a>                      <span class="at">weightCol=</span><span class="st">&quot;V5&quot;</span>, <span class="at">chrs=</span>chr, <span class="at">xlim=</span><span class="fu">c</span>(x_min, x_max),</span>
<span id="cb27-64"><a href="cases.html#cb27-64" tabindex="-1"></a>                      <span class="at">ylab =</span> <span class="st">&quot;K562 ChIP-seq&quot;</span>, <span class="at">title =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb27-65"><a href="cases.html#cb27-65" tabindex="-1"></a>                  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2000</span>)) <span class="sc">+</span> </span>
<span id="cb27-66"><a href="cases.html#cb27-66" tabindex="-1"></a>                  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">43737946</span>,<span class="at">xmax =</span> <span class="dv">43754223</span>,</span>
<span id="cb27-67"><a href="cases.html#cb27-67" tabindex="-1"></a>                           <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">2000</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb27-68"><a href="cases.html#cb27-68" tabindex="-1"></a>                  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">43900000</span>,<span class="at">xmax =</span> <span class="dv">44000000</span>,</span>
<span id="cb27-69"><a href="cases.html#cb27-69" tabindex="-1"></a>                           <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">2000</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb27-70"><a href="cases.html#cb27-70" tabindex="-1"></a>                  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="dv">44060000</span>,<span class="at">xmax =</span> <span class="dv">44100000</span>,</span>
<span id="cb27-71"><a href="cases.html#cb27-71" tabindex="-1"></a>                           <span class="at">ymin=</span> <span class="dv">0</span>, <span class="at">ymax=</span><span class="dv">2000</span>, <span class="at">fill =</span>  <span class="st">&quot;#c6c3c3&quot;</span> , <span class="at">alpha=</span> <span class="fl">0.2</span>) <span class="sc">+</span>  </span>
<span id="cb27-72"><a href="cases.html#cb27-72" tabindex="-1"></a>                  <span class="fu">facet_grid</span>(.id <span class="sc">~</span> .) <span class="sc">+</span> </span>
<span id="cb27-73"><a href="cases.html#cb27-73" tabindex="-1"></a>                  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-74"><a href="cases.html#cb27-74" tabindex="-1"></a>                  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb27-75"><a href="cases.html#cb27-75" tabindex="-1"></a>                  <span class="fu">theme</span>(<span class="at">strip.text.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb27-76"><a href="cases.html#cb27-76" tabindex="-1"></a></span>
<span id="cb27-77"><a href="cases.html#cb27-77" tabindex="-1"></a>K562_p <span class="ot">&lt;-</span> (K562_hic_p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-78"><a href="cases.html#cb27-78" tabindex="-1"></a>             <span class="fu">insert_bottom</span>(K562_cov_p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-79"><a href="cases.html#cb27-79" tabindex="-1"></a>             <span class="fu">insert_bottom</span>(gene_p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>), <span class="at">height =</span> .<span class="dv">6</span>)</span>
<span id="cb27-80"><a href="cases.html#cb27-80" tabindex="-1"></a></span>
<span id="cb27-81"><a href="cases.html#cb27-81" tabindex="-1"></a>hic_legend <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">get_legend</span>(K562_hic_p)</span>
<span id="cb27-82"><a href="cases.html#cb27-82" tabindex="-1"></a>cov_legend <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">get_legend</span>(K562_cov_p)</span>
<span id="cb27-83"><a href="cases.html#cb27-83" tabindex="-1"></a></span>
<span id="cb27-84"><a href="cases.html#cb27-84" tabindex="-1"></a>combined_legends <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(hic_legend, cov_legend, <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb27-85"><a href="cases.html#cb27-85" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_list</span>(<span class="at">gglist =</span> <span class="fu">list</span>(GM12878_p, K562_p, combined_legends),</span>
<span id="cb27-86"><a href="cases.html#cb27-86" tabindex="-1"></a>               <span class="at">design =</span> <span class="fu">c</span>(<span class="st">&quot;AAAAAABBBBBBCC&quot;</span>))</span>
<span id="cb27-87"><a href="cases.html#cb27-87" tabindex="-1"></a></span>
<span id="cb27-88"><a href="cases.html#cb27-88" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="aplot_files/figure-html/split_data-1.png" width="1536" /></p>

</div>
</div>
</div>






            </section>

          </div>
        </div>
      </div>
<a href="align-associated-subplots.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
